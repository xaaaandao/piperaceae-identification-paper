from unittest import TestCase

import numpy

from cp.samples import get_index, Index


class Test(TestCase):
    cfg = {
        "fold": 5,
        "n_labels": 5,
        "path_base": "dataset",
        "path_out": "out",
        "pca": True,
        "test_size": 0.2,
        "train_size": 0.8,
    }
    index_train_zero = numpy.array(
        [45, 51, 123, 184, 240, 344, 32, 124, 187, 56, 145, 300, 209, 34, 146, 264, 133, 219, 197, 363, 303, 296, 332,
         279, 353, 46, 143, 319, 89, 314, 155, 277, 175, 101, 59, 331, 287, 53, 350, 69, 177, 134, 194, 136, 81, 91, 63,
         269,
         348, 225, 149, 245, 335, 152, 29, 228, 115, 52, 355, 92, 334, 318, 274, 294, 139, 180, 299, 104, 226, 337, 346,
         61, 313, 362, 55, 302, 31, 24, 27, 185, 19, 43, 242, 280, 193, 116, 150, 243, 374, 129, 154, 202, 328, 330,
         118,
         47, 102, 112, 106, 265, 227, 71, 157, 127, 161, 321, 168, 39, 315, 158, 128, 13, 176, 131, 365, 41, 297, 292,
         317,
         329, 119, 327, 281, 221, 87, 75, 238, 58, 174, 270, 156, 324, 268, 372, 94, 23, 253, 213, 141, 126, 288, 86,
         103,
         178, 21, 201, 311, 293, 358, 196, 80, 301, 347, 322, 148, 316, 234, 308, 84, 360, 14, 70, 233, 60, 367, 237,
         65,
         266, 258, 82, 306, 364, 223, 67, 304, 26, 283, 220, 195, 17, 361, 320, 307, 284, 214, 117, 162, 0, 366, 48,
         286,
         183, 73, 110, 256, 36, 49, 105, 3, 215, 236, 250, 93, 212, 340, 275, 341, 224, 289, 114, 336, 217, 132, 231,
         345,
         97, 222, 2, 273, 208, 108, 199, 166, 88, 276, 54, 15, 125, 153, 357, 68, 30, 246, 218, 241, 78, 142, 122, 28,
         42,
         295, 138, 7, 204, 351, 135, 167, 323, 291, 38, 44, 190, 349, 151, 179, 310, 252, 260, 191, 159, 188, 66, 216,
         235,
         33, 271, 140, 4, 173, 186, 120, 181, 200, 164, 77, 57, 282, 370, 95, 210, 79, 40, 342, 248, 230, 8, 11, 267,
         368,
         165, 261, 254, 373, 111, 10, 96, 247, 22, 229, 35])
    index_test_zero = numpy.array(
        [192, 98, 259, 16, 343, 305, 244, 205, 144, 249, 339, 107, 9, 278, 37, 72, 312, 130, 160, 333, 285, 170, 232,
         272,
         255, 206, 100, 90, 356, 25, 325, 203, 352, 371, 211, 5, 137, 109, 18, 64, 50, 290, 121, 172, 359, 298, 169,
         171,
         163, 99, 369, 147, 262, 62, 113, 76, 83, 20, 12, 239, 1, 207, 257, 74, 6, 189, 326, 85, 251, 198, 263, 182,
         354,
         338, 309])

    index_train_one = numpy.array(
        [195, 266, 294, 4, 213, 34, 30, 281, 277, 162, 40, 319, 1, 344, 202, 112, 175, 278, 95, 109, 369, 20, 187, 71,
         64,
         233, 298, 293, 89, 271, 87, 351, 334, 48, 24, 289, 242, 182, 132, 148, 82, 137, 98, 141, 49, 333, 200, 17, 125,
         363, 373, 26, 158, 350, 214, 66, 237, 285, 273, 288, 296, 260, 305, 282, 336, 10, 77, 2, 0, 197, 90, 111, 249,
         367,
         13, 57, 63, 215, 149, 247, 360, 23, 140, 75, 143, 172, 307, 5, 230, 91, 252, 150, 83, 168, 192, 123, 177, 264,
         114,
         374, 355, 198, 291, 244, 265, 297, 188, 147, 166, 157, 354, 99, 300, 324, 138, 15, 170, 335, 205, 145, 228,
         156,
         235, 11, 206, 69, 219, 251, 232, 127, 217, 70, 174, 101, 274, 226, 146, 238, 221, 134, 122, 225, 234, 366, 299,
         173, 241, 201, 130, 78, 323, 160, 159, 328, 18, 280, 312, 131, 353, 88, 322, 135, 35, 345, 340, 164, 371, 179,
         211,
         31, 129, 343, 92, 184, 167, 41, 55, 240, 120, 210, 152, 44, 85, 27, 231, 287, 357, 310, 29, 100, 37, 212, 50,
         59,
         110, 321, 190, 315, 171, 47, 81, 28, 22, 292, 51, 103, 45, 139, 349, 346, 223, 284, 303, 133, 253, 309, 269,
         191,
         8, 263, 56, 54, 337, 52, 304, 185, 128, 65, 86, 347, 208, 6, 339, 67, 165, 53, 42, 358, 117, 180, 320, 372, 60,
         283, 189, 342, 313, 19, 295, 136, 361, 227, 80, 317, 3, 113, 25, 239, 308, 169, 326, 94, 104, 154, 314, 16,
         196,
         256, 9, 73, 186, 183, 243, 301, 46, 272, 348, 142, 261, 255, 246, 108, 327, 38, 341, 199, 330, 258, 178, 306,
         220,
         370, 316, 245, 270, 97, 194, 218, 115, 106])
    index_test_one = numpy.array(
        [254, 318, 39, 216, 338, 248, 268, 236, 61, 116, 43, 203, 311, 181, 74, 161, 290, 257, 368, 362, 155, 144, 332,
         118,
         302, 7, 364, 262, 229, 176, 224, 356, 107, 207, 151, 76, 72, 286, 352, 84, 204, 222, 126, 33, 124, 325, 193,
         276,
         250, 12, 93, 163, 279, 96, 105, 153, 121, 331, 329, 36, 259, 102, 359, 79, 275, 21, 58, 68, 62, 14, 209, 365,
         32,
         119, 267])

    index_train_two = numpy.array(
        [318, 331, 95, 224, 138, 360, 113, 262, 247, 40, 86, 66, 79, 191, 319, 320, 129, 189, 278, 178, 0, 2, 208, 60,
         186,
         53, 296, 93, 366, 187, 308, 356, 159, 348, 205, 241, 240, 3, 352, 36, 170, 274, 153, 13, 280, 287, 350, 58, 46,
         222, 148, 19, 204, 207, 85, 102, 231, 251, 78, 264, 17, 223, 362, 323, 256, 282, 359, 30, 344, 114, 322, 249,
         185,
         283, 52, 110, 197, 214, 4, 127, 112, 301, 237, 260, 84, 50, 229, 165, 5, 41, 32, 111, 219, 263, 217, 314, 373,
         157,
         192, 304, 72, 174, 335, 294, 202, 163, 140, 225, 147, 71, 183, 141, 275, 171, 265, 135, 7, 255, 172, 212, 91,
         324,
         31, 68, 190, 281, 70, 11, 311, 292, 118, 258, 38, 73, 316, 213, 87, 298, 164, 23, 119, 162, 200, 182, 220, 128,
         242, 77, 195, 293, 179, 303, 234, 156, 143, 134, 122, 9, 142, 28, 104, 349, 43, 39, 290, 136, 369, 279, 1, 313,
         145, 109, 154, 315, 101, 33, 69, 211, 126, 354, 155, 97, 12, 133, 305, 329, 243, 289, 340, 271, 347, 269, 284,
         158,
         125, 173, 20, 353, 334, 371, 120, 248, 44, 160, 180, 100, 232, 332, 83, 199, 365, 226, 130, 341, 176, 80, 267,
         307,
         89, 299, 82, 88, 55, 106, 54, 90, 22, 288, 276, 325, 8, 45, 139, 363, 132, 166, 268, 63, 230, 266, 206, 198,
         374,
         227, 34, 342, 16, 272, 302, 361, 117, 297, 124, 312, 244, 257, 194, 327, 218, 26, 21, 201, 6, 116, 144, 121,
         306,
         273, 67, 188, 346, 372, 37, 150, 131, 210, 24, 295, 368, 254, 65, 351, 317, 137, 358, 357, 270, 370, 48, 61,
         56,
         238, 64, 181, 328, 108, 235, 59, 337, 196])
    index_test_two = numpy.array(
        [105, 99, 42, 14, 236, 98, 49, 115, 221, 321, 193, 355, 10, 339, 169, 151, 96, 74, 146, 252, 209, 286, 152, 103,
         326, 261, 250, 92, 333, 246, 75, 51, 47, 216, 300, 57, 76, 259, 62, 177, 215, 310, 203, 94, 245, 25, 107, 285,
         29,
         309, 228, 338, 161, 336, 277, 364, 27, 253, 15, 18, 168, 81, 149, 345, 175, 167, 123, 35, 330, 343, 184, 291,
         233,
         239, 367])

    index_train_three = numpy.array(
        [23, 231, 221, 287, 156, 330, 373, 69, 372, 94, 99, 279, 207, 41, 276, 235, 1, 277, 57, 225, 323, 76, 348, 220,
         25,
         37, 197, 245, 302, 240, 43, 14, 327, 237, 227, 122, 159, 9, 190, 63, 228, 15, 140, 120, 18, 92, 125, 319, 234,
         205,
         294, 85, 359, 45, 273, 121, 46, 192, 258, 126, 246, 236, 148, 73, 115, 62, 24, 349, 142, 91, 20, 100, 165, 298,
         26,
         127, 8, 345, 244, 333, 337, 160, 12, 130, 340, 31, 113, 223, 134, 184, 344, 317, 253, 269, 110, 93, 153, 154,
         179,
         133, 278, 198, 13, 119, 194, 331, 201, 216, 352, 163, 10, 332, 247, 354, 67, 111, 21, 217, 304, 185, 281, 17,
         65,
         56, 155, 178, 350, 232, 265, 105, 109, 88, 71, 167, 27, 369, 335, 30, 291, 74, 22, 0, 342, 308, 151, 49, 286,
         79,
         290, 114, 124, 367, 307, 123, 285, 177, 293, 83, 361, 68, 259, 40, 238, 191, 289, 131, 305, 152, 351, 296, 280,
         129, 70, 264, 233, 261, 353, 292, 180, 230, 199, 166, 97, 316, 271, 347, 358, 229, 315, 366, 309, 186, 311,
         226,
         146, 47, 64, 272, 147, 222, 329, 19, 288, 182, 158, 149, 60, 81, 257, 98, 204, 86, 48, 211, 365, 370, 175, 355,
         128, 301, 44, 145, 59, 336, 103, 138, 61, 260, 38, 6, 55, 275, 346, 356, 284, 371, 362, 210, 102, 313, 268,
         200,
         183, 174, 135, 117, 341, 107, 96, 164, 3, 209, 243, 252, 106, 34, 297, 139, 168, 328, 320, 58, 51, 144, 249,
         334,
         266, 28, 29, 255, 118, 101, 104, 150, 4, 343, 84, 33, 189, 218, 241, 202, 181, 224, 90, 338, 171, 215, 219,
         303,
         214, 157, 78, 306, 299, 53, 364, 321, 173, 162])
    index_test_three = numpy.array(
        [326, 170, 7, 11, 242, 42, 360, 16, 108, 324, 143, 270, 137, 32, 250, 193, 5, 295, 196, 310, 80, 206, 322, 212,
         314,
         2, 187, 239, 339, 203, 141, 357, 66, 39, 195, 112, 132, 52, 251, 363, 254, 213, 36, 318, 95, 248, 325, 176,
         374,
         75, 312, 188, 208, 136, 50, 274, 89, 77, 72, 35, 169, 263, 172, 161, 256, 54, 300, 262, 283, 368, 116, 267, 82,
         87,
         282])

    index_train_four = numpy.array(
        [258, 167, 171, 323, 346, 303, 309, 184, 78, 147, 32, 280, 350, 206, 130, 225, 212, 372, 89, 55, 133, 118, 200,
         273,
         170, 257, 261, 53, 36, 291, 314, 210, 103, 60, 122, 290, 120, 300, 145, 222, 234, 209, 98, 18, 325, 345, 340,
         333,
         178, 344, 359, 351, 21, 62, 174, 15, 349, 321, 143, 192, 307, 215, 329, 208, 33, 275, 260, 319, 370, 243, 152,
         48,
         124, 166, 146, 292, 374, 74, 358, 287, 201, 277, 179, 160, 157, 115, 1, 233, 125, 310, 363, 248, 93, 99, 240,
         226,
         237, 137, 69, 188, 182, 238, 308, 272, 331, 121, 296, 242, 348, 320, 168, 219, 135, 148, 25, 92, 269, 11, 7,
         10,
         270, 35, 367, 68, 205, 126, 101, 263, 64, 173, 31, 37, 283, 96, 3, 106, 284, 315, 72, 265, 295, 322, 172, 47,
         175,
         364, 342, 198, 305, 81, 249, 282, 211, 239, 352, 259, 202, 63, 356, 337, 328, 24, 107, 293, 252, 38, 301, 65,
         39,
         366, 105, 5, 100, 110, 207, 77, 164, 22, 304, 144, 41, 254, 203, 97, 161, 40, 52, 298, 94, 79, 59, 46, 268, 67,
         49,
         317, 353, 313, 193, 217, 13, 26, 279, 231, 154, 71, 116, 326, 250, 82, 30, 9, 163, 85, 266, 204, 19, 216, 181,
         76,
         16, 17, 289, 138, 213, 241, 50, 365, 288, 28, 54, 132, 335, 274, 151, 84, 229, 236, 244, 197, 255, 339, 285,
         185,
         195, 355, 194, 232, 297, 87, 43, 86, 177, 29, 338, 123, 45, 316, 186, 220, 56, 276, 131, 256, 104, 113, 153,
         176,
         271, 362, 134, 158, 51, 368, 235, 343, 330, 230, 91, 311, 70, 111, 159, 114, 223, 88, 336, 327, 196, 149, 14,
         156,
         324, 44, 75, 20, 83, 142, 95, 224])
    index_test_four = numpy.array(
        [42, 318, 141, 245, 286, 373, 369, 80, 334, 267, 189, 128, 221, 136, 228, 150, 199, 332, 8, 360, 58, 102, 139,
         354,
         187, 361, 347, 0, 27, 169, 246, 6, 140, 278, 294, 12, 190, 227, 61, 162, 90, 253, 264, 180, 299, 109, 112, 312,
         66,
         357, 183, 108, 127, 306, 155, 371, 247, 341, 214, 23, 165, 57, 34, 2, 117, 251, 262, 4, 302, 119, 73, 129, 218,
         281, 191])
    list_index = list([])

    def setUp(self) -> None:
        self.create_list_index()
        super().setUp()

    def test_index(self):
        index = get_index(self.cfg, "../dataset/surf64.txt")

        for i in index:
            self.assertTrue(any(getattr(i, "index_train").tolist() == getattr(j, "index_train").tolist() for j in self.list_index))

    def create_list_index(self):
        self.list_index.append(Index(None, self.index_train_zero, self.index_test_zero))
        self.list_index.append(Index(None, self.index_train_one, self.index_test_one))
        self.list_index.append(Index(None, self.index_train_two, self.index_test_two))
        self.list_index.append(Index(None, self.index_train_three, self.index_test_three))
        self.list_index.append(Index(None, self.index_train_four, self.index_test_four))